# Кинопоиск

## Содержание

* [Описание запуска frontend-проекта](#frontend)
* [Описание запуска backend-проекта](#backend)
* [Опции проекта](#option)

## Описание запуска frontend-проекта

<a id="frontend"></a>
---

1. Для начала нужно скачать и установить [NodeJS](https://nodejs.org/en/download/)
2. Проверить, что в консоль установлена утилита npm

```shell
npm -v
```

3. Перейти в корень frontend-проекта

```shell
cd frontend
```

4. Для установки необходимых зависимостей написать команду:

```shell
npm install
```

> Адрес, по которому будет frontend ожидать backend
> приложение [http://127.0.0.1:5000](http://127.0.0.1:5000)

5. Запуск проекта

```shell
npm run start
```

Запуск проекта. Откройте [http://localhost:3000](http://localhost:3000) для просмотра в браузере.
Если не удалось запустить приложение этой командой, используйте команду ниже.

```shell
npm run start-legacy
```

Запуск проекта (Если первая команда выполнилась с ошибкой). Откройте [http://localhost:3000](http://localhost:3000) для
просмотра в браузере.

---

## Описание запуска backend-проекта

<a id="backend"></a>
---
- Установка виртуального окружения

```shell
python -m venv venv
```
- Запуск виртуального окружения

```shell
venv\Scripts\activate
```

- Установка зависимостей

```shell
pip install -r requirements.txt
```


- Создать в корне проекта файл с названием `.env` и добавить в него ключ=значения

```
FLASK_APP='run'
FLASK_ENV='development'
```

- Создание моделей (очистит БД и создаст все модели, указанные в импорте)

```shell
python create_tables.py
```

- Загрузка данных в базу

```shell
python load_fixtures.py
```

Скрипт читает файл fixtures.json и загружает данные в базу. Если данные уже загружены - выводит соответсвующее
сообщение.

### Запуск проекта

```shell
flask run
```

Ссылка на RestAPI [http://127.0.0.1:5000/docs](http://127.0.0.1:5000/docs)

### Запуск тестов

```shell
pytest
```
Тестирует config, DAOs, Services, Views

---

## Опции проекта
<a id="option"></a>

| Адрес                    | Методы                        | Авторизация | Описание                                                                     |
|--------------------------|-------------------------------|-------------|------------------------------------------------------------------------------|
| `/movies/`               | `GET` параметры: status, page | нет         | Позволяет получить все фильмы из базы данных                                 |
| `/movies/<id>/`          | `GET`                         | нет         | Позволяет получить фильм из базы данных по id                                |
| `/genres/`               | `GET` параметры: page         | нет         | Позволяет получить все фильмы из базы данных                                 |
| `/genres/<id>/`          | `GET`                         | нет         | Позволяет получить фильм из базы данных по id                                |
| `/directors/`            | `GET` параметры: page         | нет         | Позволяет получить все фильмы из базы данных                                 |
| `/directors/<id>/`       | `GET`                         | нет         | Позволяет получить фильм из базы данных по id                                |
| `/auth/register/`        | `POST`                        | нет         | Регистрирует нового пользователя                                             |
| `/auth/login/`           | `POST`                        | нет         | Выдает зарегистрированному пользователю токены доступа                       |
| `/auth/login/`           | `PUT`                         | нет         | Обновляет зарегистрированному пользователю токены доступа                    |
| `/user/`                 | `GET`                         | да          | Позволяет получить данные зарегистрированного пользователя                   |
| `/user/`                 | `PATCH`                       | да          | Позволяет изменить информацию пользователя (имя, фамилия, любимый жанр)      |
| `/user/password/`        | `PUT`                         | да          | Позволяет изменить пароль зарегистрированного пользователя                   |
| `/favorites/movies/`     | `GET`                         | да          | Позволяет получить список избранных фильмов зарегистрированного пользователя |
| `/favorites/movies/<id>` | `POST`                        | да          | Позволяет добавить фильм в список избранных зарегистрированного пользователя |
| `/favorites/movies/<id>` | `DELETE`                      | да          | Позволяет удалить фильм из списка избранных зарегистрированного пользователя |

Параметры:
- status - `str` - При значении `new` сортирует фильмы по году
- page - `int` - Выводит 12 элементов указанной страницы